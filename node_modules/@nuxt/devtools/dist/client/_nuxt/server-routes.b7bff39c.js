import{_ as de}from"./Navbar.vue.73274a4d.js";import{g as J,r as j,o as n,c as p,h as c,w as i,a as d,n as R,q as e,b0 as A,t as T,s as S,d as C,S as pe,ad as me,e as fe,a1 as ve,F as B,m as M,P as Y,V as _e,ai as he,l as h,T as ye,I as ee,b as l,j as ge,J as be,b1 as xe,E as Ce,b2 as ke,Z as $e,b3 as Re,a8 as Te}from"./entry.51f9b393.js";import{_ as te}from"./Badge.6957c09f.js";import{_ as Se}from"./NSelect.vue.bf162e70.js";import{_ as we}from"./CodeSnippets.vue.c709c5db.js";import{_ as oe}from"./NPanelGrids.017932a3.js";import{_ as je}from"./NCodeBlock.vue.09bc830f.js";import{C as X}from"./constants.d7bcda3c.js";import{_ as qe}from"./PanelLeftRight.vue.747d389a.js";import"./client.0c1ac957.js";const Ve=d("div",{"x-divider":""},null,-1),ne=J({__name:"ServerRouteListItem",props:{item:{},index:{default:0}},setup(O){const U=j(!0);return(a,r)=>{const L=Y,q=te,w=ne;return n(),p("div",null,[(n(),c(me(a.item.routes?"button":e(fe)),{flex:"~ gap-2","w-full":"","items-center":"","hover-bg-active":"",px2:"",py1:"",class:R([{"bg-active":a.$route.query.path===a.item.route}]),style:pe({paddingLeft:`calc(0.5rem + ${a.index*1.5}em)`}),to:{query:{path:a.item.route}},onClick:r[0]||(r[0]=N=>U.value=!e(U))},{default:i(()=>[d("div",{class:R({"w-12":!a.item.routes}),"flex-none":"","text-left":""},[a.item.type==="collection"?(n(),c(L,{key:0,icon:"carbon:chevron-right","mb0.5":"","transform-rotate":e(U)?90:0,transition:""},null,8,["transform-rotate"])):(n(),c(q,{key:1,class:R(("getRequestMethodClass"in a?a.getRequestMethodClass:e(A))(a.item.method||"*")),textContent:T((a.item.method||"*").toUpperCase())},null,8,["class","textContent"]))],2),d("span",{class:R({"flex items-center":a.item.routes}),"flex-auto":"","text-sm":"","font-mono":""},[a.item.type==="collection"?(n(),c(L,{key:0,title:`${a.item.routes?.length} routes`,icon:"carbon:folder",mr1:""},null,8,["title"])):S("",!0),C(" "+T(a.item.route),1)],2)]),_:1},8,["class","style","to"])),Ve,e(U)?ve(a.$slots,"default",{key:0},()=>[(n(!0),p(B,null,M(a.item.routes,N=>(n(),c(w,{key:N.filepath,item:N,index:a.index+1},null,8,["item","index"]))),128))]):S("",!0)])}}}),Ee={"h-full":"","w-full":"",flex:"~ col"},Ue={flex:"~ col gap-2","flex-none":"",p4:"","navbar-glass":""},Le={flex:"~ gap2"},Ne={flex:"~ gap2","w-full":"","items-center":"",px4:"",pb2:"","text-center":"","text-sm":"",border:"b base"},Pe=d("div",{"flex-auto":""},null,-1),Be={key:0,border:"b base","items-center":"",px4:"",py2:"",grid:"~ cols-[max-content_1fr] gap-2"},Oe={"text-right":"","font-mono":""},De={key:1,relative:""},Me={key:2,px4:"",py2:"",flex:"~ col gap-2",border:"b base"},Ie={border:"b base",flex:"~ gap2","items-center":"",px4:"",py2:""},Fe=d("div",null,"Response",-1),Ge={key:1,"text-xs":"",op50:""},We=d("div",{"flex-auto":""},null,-1),Ae=d("div",{op50:""}," Request finished in ",-1),He={key:1,"flex-auto":"","overflow-auto":"",p4:""},ze={border:"~ base",rounded:""},Je=["src"],Ke={key:1,controls:"",rounded:""},Qe=["src"],Ze=J({__name:"ServerRouteDetails",props:{route:{type:Object,required:!0}},setup(O){const U=O,a=_e(),r=he({contentType:"text/plain",data:"",statusCode:200,error:void 0}),L=h(()=>r.contentType.includes("application/json")?"json":r.contentType.includes("text/html")?"html":r.contentType.includes("text/css")?"css":r.contentType.includes("text/javascript")?"javascript":r.contentType.includes("image")||r.contentType.includes("video")?"media":r.contentType.includes("text/xml")||r.contentType.includes("application/xml")?"xml":"text"),q=h(()=>{if(L.value==="json")return JSON.stringify(r.data,null,2);if(L.value==="media"){const o=new Blob([r.data],{type:r.contentType});return URL.createObjectURL(o)}return r.data}),w=j(0),N=j(!1),y=j(!1),V=ye(),D=h(()=>U.route.route?.split(/((?:\*\*)?:[\w_]+)/g)),m=h(()=>D.value?.filter(o=>o.startsWith(":")||o.startsWith("**:"))||[]),f=j(U.route.method||"GET"),P=j({}),b=j([{key:"",value:""}]),x=j([{key:"",value:""}]),v=j([{key:"Content-Type",value:"application/json"}]),E=h(()=>x.value.filter(({key:o})=>o).length),K=h(()=>v.value.filter(({key:o})=>o).length),H=h(()=>{const o={};for(let t=0;t<b.value.length;t++){const{key:s,value:_}=b.value[t];o[s]=_}return Object.keys(o)[0]?o:null}),se=h(()=>{let o=a.value?.devServer.url||"http://localhost";o.charAt(o.length-1)==="/"&&(o=o.slice(0,-1));const t=a.value?.devServer.port||3e3;return o.includes(`:${t}`)?o:`${o}:${t}`}),I=h(()=>{let o=new URLSearchParams(Object.fromEntries(x.value.filter(({key:_})=>_).map(({key:_,value:k})=>[_,k]))).toString();o&&(o=`?${o}`);const t=(D.value?.map(_=>(_.startsWith(":")||_.startsWith("**:"))&&P.value[_]||_).join("")||"")+o;let s=a.value?.app.baseURL||"";return(s==="./"||s===".")&&(s=""),s.endsWith("/")&&(s=s.slice(0,-1)),s+t}),re=h(()=>se.value+I.value);async function Q(){y.value=!0,N.value=!0,Object.assign(r,{lang:"text",contentType:"",data:"",content:"",error:void 0});const o=Date.now();try{r.data=await $fetch(re.value,{method:f.value.toUpperCase(),headers:Object.fromEntries(v.value.filter(({key:t,value:s})=>t&&s).map(({key:t,value:s})=>[t,s])),query:Object.fromEntries(x.value.filter(({key:t,value:s})=>t&&s).map(({key:t,value:s})=>[t,s])),body:H.value,onResponse({response:t}){r.contentType=(t.headers.get("content-type")||"").toString().toLowerCase().trim(),r.statusCode=t.status},onResponseError(t){r.error=t.response._data,r.data=t.response._data}})}catch{}N.value=!1,w.value=Date.now()-o}const Z=h(()=>{const o=[],t=[],s=v.value.filter(({key:k,value:$})=>k&&$&&!(k==="Content-Type"&&$==="application/json")).map(({key:k,value:$})=>`  '${k}': '${$}'`).join(`,
`);f.value.toUpperCase()!=="GET"&&t.push(`method: '${f.value.toUpperCase()}'`),s&&t.push(`headers: {
${s}
}`),H.value&&t.push(`body: ${JSON.stringify(H.value,null,2)}`);const _=t.length?`, {
${t.join(`,
`).split(`
`).map(k=>`  ${k}`).join(`
`)}
}`:"";return o.push({name:"useFetch",lang:"javascript",docs:X.nuxt.useFetch,code:`const { data, pending, error, refresh } = useFetch('${I.value}'${_})`}),o.push({name:"$fetch",lang:"javascript",docs:X.nuxt.$fetch,code:`await $fetch('${I.value}'${_})`}),o}),g=j(m.value.length?"params":"query"),F=h(()=>{if(g.value==="query")return x.value;if(g.value==="body")return b.value;if(g.value==="headers")return v.value}),ae=["GET","POST","PUT","PATCH","DELETE","HEAD"];return(o,t)=>{const s=ge,_=Se,k=be,$=Y,le=we,ue=oe,ie=xe,z=te,ce=je;return n(),p("div",Ee,[d("div",Ue,[d("div",Le,[O.route.method?(n(),c(s,{key:0,class:R(("getRequestMethodClass"in o?o.getRequestMethodClass:e(A))(e(f))),"pointer-events-none":"",tabindex:"-1"},{default:i(()=>[C(T(e(f).toUpperCase()),1)]),_:1},8,["class"])):(n(),c(_,{key:1,modelValue:e(f),"onUpdate:modelValue":t[0]||(t[0]=u=>ee(f)?f.value=u:null),class:R(("getRequestMethodClass"in o?o.getRequestMethodClass:e(A))(e(f)))},{default:i(()=>[(n(),p(B,null,M(ae,u=>d("option",{key:u,class:R(("getRequestMethodClass"in o?o.getRequestMethodClass:e(A))(u))},T(u.toUpperCase()),3)),64))]),_:1},8,["modelValue","class"])),l(k,{"model-value":e(I),disabled:"","flex-auto":"","font-mono":"",p:"x5 y2",n:"primary xs"},null,8,["model-value"]),l(s,{n:"primary solid",onClick:Q},{default:i(()=>[l($,{icon:"carbon:send"})]),_:1})])]),d("div",Ne,[e(m).length?(n(),c(s,{key:0,class:R(e(g)==="params"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[1]||(t[1]=u=>g.value="params")},{default:i(()=>[l($,{icon:"i-carbon-text-selection"}),C(" Params ("+T(e(m).length)+") ",1)]),_:1},8,["class"])):S("",!0),l(s,{class:R(e(g)==="query"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[2]||(t[2]=u=>g.value="query")},{default:i(()=>[l($,{icon:"i-carbon-help"}),C(" Query "+T(e(E)?`(${e(E)})`:""),1)]),_:1},8,["class"]),e(f)!=="GET"?(n(),c(s,{key:1,class:R(e(g)==="body"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[3]||(t[3]=u=>g.value="body")},{default:i(()=>[l($,{icon:"i-carbon-document"}),C(" Body ")]),_:1},8,["class"])):S("",!0),l(s,{class:R(e(g)==="headers"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[4]||(t[4]=u=>g.value="headers")},{default:i(()=>[l($,{icon:"i-carbon-html-reference"}),C(" Headers "+T(e(K)?`(${e(K)})`:""),1)]),_:1},8,["class"]),l(s,{class:R(e(g)==="snippet"?"text-primary n-primary":"border-transparent! shadow-none!"),onClick:t[5]||(t[5]=u=>g.value="snippet")},{default:i(()=>[l($,{icon:"carbon:code"}),C(" Snippets ")]),_:1},8,["class"]),Pe,l(s,{icon:"carbon-launch",onClick:t[6]||(t[6]=u=>e(V)(O.route.filepath))},{default:i(()=>[C(" Open in Editor ")]),_:1})]),e(g)==="params"?(n(),p("div",Be,[(n(!0),p(B,null,M(e(m),u=>(n(),p(B,{key:u},[d("div",Oe,T(u),1),l(k,{modelValue:e(P)[u],"onUpdate:modelValue":G=>e(P)[u]=G,placeholder:u,"flex-1":""},null,8,["modelValue","onUpdate:modelValue","placeholder"])],64))),128))])):S("",!0),e(g)==="snippet"?(n(),p("div",De,[e(Z).length?(n(),c(le,{key:0,border:"b base","code-snippets":e(Z)},null,8,["code-snippets"])):S("",!0)])):e(F)?(n(),p("div",Me,[(n(!0),p(B,null,M(e(F),(u,G)=>(n(),p("div",{key:G,flex:"~ gap-2","justify-around":""},[l(k,{modelValue:u.key,"onUpdate:modelValue":W=>u.key=W,placeholder:"Key","flex-1":"","font-mono":"",n:"sm"},null,8,["modelValue","onUpdate:modelValue"]),l(k,{modelValue:u.value,"onUpdate:modelValue":W=>u.value=W,placeholder:"Value","flex-1":"","font-mono":"",n:"sm"},null,8,["modelValue","onUpdate:modelValue"]),l(s,{n:"red",onClick:W=>e(F).splice(G,1)},{default:i(()=>[l($,{icon:"carbon:delete"})]),_:2},1032,["onClick"])]))),128)),d("div",null,[l(s,{icon:"carbon-add",n:"sm primary",my1:"","px-3":"",onClick:t[7]||(t[7]=u=>e(F).push({key:"",value:""}))},{default:i(()=>[C(" Add ")]),_:1})])])):S("",!0),e(y)?e(N)?(n(),c(ie,{key:4,"z-10":"","flex-auto":"","backdrop-blur":""},{default:i(()=>[C(" Fetching... ")]),_:1})):(n(),p(B,{key:5},[d("div",Ie,[Fe,e(r).error?(n(),c(z,{key:0,"bg-red-400:10":"","text-red-400":""},{default:i(()=>[C(" Error ")]),_:1})):S("",!0),l(z,{class:R({"bg-orange-400:10 text-orange-400":e(r).error,"bg-green-400:10 text-green-400":!e(r).error})},{default:i(()=>[C(T(e(r).statusCode),1)]),_:1},8,["class"]),e(r).contentType?(n(),p("code",Ge,T(e(r).contentType),1)):S("",!0),We,Ae,l(z,{"bg-green-400:10":"","text-green-400":""},{default:i(()=>[C(T(e(w))+" ms ",1)]),_:1})]),e(L)!=="media"?(n(),c(ce,{key:0,"flex-auto":"","overflow-auto":"","py-2":"",code:e(q),lang:e(L)},null,8,["code","lang"])):(n(),p("div",He,[d("div",ze,[e(r).contentType.includes("image")?(n(),p("img",{key:0,rounded:"",src:e(q)},null,8,Je)):(n(),p("video",Ke,[d("source",{src:e(q),type:"video/mp4"},null,8,Qe)]))])]))],64)):(n(),c(ue,{key:3},{default:i(()=>[l(s,{n:"primary",onClick:Q},{default:i(()=>[l($,{icon:"carbon:send"}),C(" Send request ")]),_:1})]),_:1}))])}}}),Xe={flex:"~ gap1","text-sm":""},Ye={key:0,op50:""},et={op50:""},tt=d("span",{op75:""},"Select a route to start",-1),pt=J({__name:"server-routes",setup(O){const U=Ce(),a=ke(),r=h(()=>{const y=[],V=(m,f)=>{m.routes=m.routes||[],m.routes.push(f)};return a.value?.forEach(m=>{const f=m.filepath.split("/"),P=f.slice(0,-1).slice(f.indexOf("server")+1);let b=null;if(P.forEach(x=>{const v=b?b.routes?.find(E=>E.route===x):y.find(E=>E.route===x);if(v)b=v;else{const E={route:x,filepath:x.replace(/\W/g,"-").toLowerCase(),type:"collection",routes:[]};b?V(b,E):y.push(E),b=E}}),m.type==="runtime"){const x=y.find(v=>v.route==="runtime");if(x)V(x,m);else{const v={route:"runtime",filepath:"runtime",type:"collection",routes:[m]};y.push(v)}}else b?V(b,m):y.push(m)}),y.length===1?y[0].routes??[]:y}),L=h(()=>new $e(a.value||[],{keys:["method","route"],shouldSort:!0})),q=h(()=>a.value?.find(y=>y.route===U.query?.path)),w=j(""),N=h(()=>a.value?w.value?L.value.search(w.value).map(V=>V.item):a.value:[]);return(y,V)=>{const D=de,m=ne,f=Ze,P=Te,b=oe,x=qe;return n(),c(x,null,{left:i(()=>[l(D,{search:e(w),"onUpdate:search":V[0]||(V[0]=v=>ee(w)?w.value=v:null),pb2:""},{default:i(()=>[d("div",Xe,[e(w)?(n(),p("span",Ye,T(e(N).length)+" matched · ",1)):S("",!0),d("span",et,T(e(a)?.length)+" routes in total",1)])]),_:1},8,["search"]),(n(!0),p(B,null,M(e(r),v=>(n(),c(m,{key:v.filepath,item:v},null,8,["item"]))),128))]),right:i(()=>[(n(),c(Re,{max:10},[e(q)?(n(),c(f,{key:e(q).filepath,route:e(q)},null,8,["route"])):S("",!0)],1024)),e(q)?S("",!0):(n(),c(b,{key:0},{default:i(()=>[l(P,{px6:"",py2:""},{default:i(()=>[tt]),_:1})]),_:1}))]),_:1})}}});export{pt as default};
